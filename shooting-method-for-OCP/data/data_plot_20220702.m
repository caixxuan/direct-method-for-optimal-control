%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 说明：对比《最优化与最优控制》 pp.257 例13.1 打靶法各方面对比
% 时间：2022/07/02
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clear;clc;close all;

%% 选择模式
mode = 'case 1';
% mode = 'case 2';

%% Case 1：不同插值方法的对比结果
if strcmp(mode,'case 1')
%% 导入数据
res_interp1   = load('SM_for_OPC_in_interp1.mat');
res_interp1q  = load('SM_for_OPC_in_interp1q.mat');
res_interp1qr = load('SM_for_OPC_in_interp1qr.mat');

%% 画图 
window_width  = res_interp1.window_width;
window_height = res_interp1.window_height;

% 柱状图
k = 0;
figure('color',[1 1 1],'position',[50+k*window_width,200,window_width,window_height]);
y = [res_interp1.time_cal; res_interp1q.time_cal; res_interp1qr.time_cal];
b = bar(y);
ch = get(b,'children');
ylabel('Calculation time'); 
set(gca,'YLim',[0,1.5],...
        'XTickLabel',{'interp1()','interp1q()','interp1qr()'},...
        'FontSize',15,...
        'FontName','Times New Roman',...
        'LineWidth',1.5);
 
text(0.66,1.41,...
     strcat(num2str(res_interp1.time_cal),'s'),...
     'FontName','Times New Roman',...
     'FontSize',12);

text(1.65,0.25,...
     strcat(num2str(res_interp1q.time_cal),'s'),...
     'FontName','Times New Roman',...
     'FontSize',12);
 
text(2.65,0.25,...
     strcat(num2str(res_interp1qr.time_cal),'s'),...
     'FontName','Times New Roman',...
     'FontSize',12);

% 状态量的图像
k = 1;
figure('color',[1 1 1],'position',[50+k*window_width,200,window_width,window_height]);
plot(res_interp1.p.t,   res_interp1.p.x,   'x-', 'LineWidth',1.5);hold on;
plot(res_interp1q.p.t,  res_interp1.p.x,   '*-', 'LineWidth',1.5);
plot(res_interp1qr.p.t, res_interp1qr.p.x, 'o-', 'LineWidth',1.5);
xlabel('Time');
ylabel('$x(t)$','interpreter','latex');
set(gca,'FontSize',15,...
        'FontName','Times New Roman',...
        'LineWidth',1.5);
legend('interp1()','interp1q()','interp1qr()',...
        'Location','Northeast',...
        'FontSize',10,...
        'FontName','Times New Roman');
    
% 控制量的图像
k = 2;
figure('color',[1 1 1],'position',[50+k*window_width,200,window_width,window_height]);
plot(res_interp1.p.t,   res_interp1.p.u,   'x-', 'LineWidth',1.5);hold on;
plot(res_interp1q.p.t,  res_interp1.p.u,   '*-', 'LineWidth',1.5);
plot(res_interp1qr.p.t, res_interp1qr.p.u, 'o-', 'LineWidth',1.5);
xlabel('Time');
ylabel('$u(t)$','interpreter','latex');
set(gca,'FontSize',15,...
        'FontName','Times New Roman',...
        'LineWidth',1.5);
legend('interp1()','interp1q()','interp1qr()',...
        'Location','Northeast',...
        'FontSize',10,...
        'FontName','Times New Roman');
end

%% Case 2：不同离散点数量对于打靶法的影响
if strcmp(mode,'case 2')
%% 导入数据
res_20points = load('SM_for_OPC_in_20points.mat');
res_30points = load('SM_for_OPC_in_30points.mat');
res_40points = load('SM_for_OPC_in_40points.mat');
res_50points = load('SM_for_OPC_in_50points.mat');

%% 画图 
window_width  = res_20points.window_width;
window_height = res_20points.window_height;

% 柱状图
k = 0;
figure('color',[1 1 1],'position',[50+k*window_width,200,window_width,window_height]);
y = [res_20points.time_cal; res_30points.time_cal; res_40points.time_cal; res_50points.time_cal];
b = bar(y);
ch = get(b,'children');
ylabel('Calculation time'); 
set(gca,'YLim',[0,2],...
        'XTickLabel',{'20 pts','30 pts','40 pts','50 pts'},...
        'FontSize',15,...
        'FontName','Times New Roman',...
        'LineWidth',1.5);
 
text(0.62,0.26,...
     strcat(num2str(res_20points.time_cal),'s'),...
     'FontName','Times New Roman',...
     'FontSize',12);

text(1.64,0.49,...
     strcat(num2str(res_30points.time_cal),'s'),...
     'FontName','Times New Roman',...
     'FontSize',12);
 
text(2.60,0.84,...
     strcat(num2str(res_40points.time_cal),'s'),...
     'FontName','Times New Roman',...
     'FontSize',12);

text(3.64,1.66,...
     strcat(num2str(res_50points.time_cal),'s'),...
     'FontName','Times New Roman',...
     'FontSize',12);
 
% 状态量的图像
k = 1;
figure('color',[1 1 1],'position',[50+k*window_width,200,window_width,window_height]);
plot(res_20points.p.t, res_20points.p.x, 'o-', 'LineWidth',1.5);hold on;
plot(res_30points.p.t, res_30points.p.x, 'o-', 'LineWidth',1.5);
plot(res_40points.p.t, res_40points.p.x, 'o-', 'LineWidth',1.5);
plot(res_50points.p.t, res_50points.p.x, 'o-', 'LineWidth',1.5);
xlabel('Time');
ylabel('$x(t)$','interpreter','latex');
set(gca,'FontSize',15,...
        'FontName','Times New Roman',...
        'LineWidth',1.5);
legend('20 pts','30 pts','40 pts','50 pts',...
        'Location','Northeast',...
        'FontSize',10,...
        'FontName','Times New Roman');
    
% 控制量的图像
k = 2;
figure('color',[1 1 1],'position',[50+k*window_width,200,window_width,window_height]);
plot(res_20points.p.t, res_20points.p.u, 'x-', 'LineWidth',1.5);hold on;
plot(res_30points.p.t, res_30points.p.u, 'x-', 'LineWidth',1.5);
plot(res_40points.p.t, res_40points.p.u, 'x-', 'LineWidth',1.5);
plot(res_50points.p.t, res_50points.p.u, 'x-', 'LineWidth',1.5);
xlabel('Time');
ylabel('$u(t)$','interpreter','latex');
set(gca,'FontSize',15,...
        'FontName','Times New Roman',...
        'LineWidth',1.5);
legend('20 pts','30 pts','40 pts','50 pts',...
        'Location','Southeast',...
        'FontSize',10,...
        'FontName','Times New Roman');
end